<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Detect runs of homozygosity using a sliding-window approach — gt_roh_window • tidypopgen</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Detect runs of homozygosity using a sliding-window approach — gt_roh_window"><meta property="og:description" content="This function uses a sliding-window approach to look for runs of homozygosity (or
heterozygosity) in a diploid genome. This function uses the package selectRUNS,
which implements an approach equivalent to the one in PLINK."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidypopgen</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9014</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/a01_overview.html">overview</a>
    </li>
    <li>
      <a href="../articles/a02_qc.html">QC</a>
    </li>
    <li>
      <a href="../articles/a03_example_clustering_and_dapc.html">example workflow with tidypopgen</a>
    </li>
    <li>
      <a href="../articles/a99_plink_cheatsheet.html">plink cheatsheet</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Detect runs of homozygosity using a sliding-window approach</h1>
    
    <div class="hidden name"><code>gt_roh_window.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function uses a sliding-window approach to look for runs of homozygosity (or
heterozygosity) in a diploid genome. This function uses the package <code>selectRUNS</code>,
which implements an approach equivalent to the one in PLINK.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gt_roh_window</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  window_size <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  min_snp <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  heterozygosity <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  max_opp_window <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  max_miss_window <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  max_gap <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fl">6</span>,</span>
<span>  min_length_bps <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  min_density <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span>  max_opp_run <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_miss_run <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a <a href="gen_tibble.html">gen_tibble</a></p></dd>


<dt>window_size</dt>
<dd><p>the size of sliding window (number of SNP loci) (default = 15)</p></dd>


<dt>threshold</dt>
<dd><p>the threshold of overlapping windows of the same state
(homozygous/heterozygous) to call a SNP in a RUN (default = 0.05)</p></dd>


<dt>min_snp</dt>
<dd><p>minimum n. of SNP in a RUN (default = 3)</p></dd>


<dt>heterozygosity</dt>
<dd><p>should we look for runs of heterozygosity (instead of homozygosity? (default = FALSE)</p></dd>


<dt>max_opp_window</dt>
<dd><p>max n. of SNPs of the opposite type (e.g. heterozygous
snps for runs of homozygosity) in the
sliding window (default = 1)</p></dd>


<dt>max_miss_window</dt>
<dd><p>max. n. of missing SNP in the sliding window (default = 1)</p></dd>


<dt>max_gap</dt>
<dd><p>max distance between consecutive SNP to be still considered a
potential run (default = 10^6 bps)</p></dd>


<dt>min_length_bps</dt>
<dd><p>minimum length of run in bps (defaults to 1000 bps = 1 kbps)</p></dd>


<dt>min_density</dt>
<dd><p>minimum n. of SNP per kbps (defaults to 0.1 = 1 SNP every 10 kbps)</p></dd>


<dt>max_opp_run</dt>
<dd><p>max n. of opposite genotype SNPs in the run (optional)</p></dd>


<dt>max_miss_run</dt>
<dd><p>max n. of missing SNPs in the run (optional)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A dataframe with RUNs of Homozygosity or Heterozygosity in the analysed dataset.
The returned dataframe contains the following seven columns: "group", "id", "chrom",
"nSNP", "from", "to", "lengthBps" (group: population, breed, case/control etc.;
id: individual identifier; chrom: chromosome on which the run is located;
nSNP: number of SNPs in the run; from: starting position of the run, in bps;
to: end position of the run, in bps; lengthBps: size of the run)</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function returns a data frame with all runs detected in the dataset.
This data frame can then be written out to a csv file.
The data frame is, in turn, the input for other functions of the detectRUNS package
that create plots and produce statistics from the results
(see plots and statistics functions in this manual,
and/or refer to the detectRUNS vignette).</p>
<p>If the <code><a href="gen_tibble.html">gen_tibble</a></code> is grouped, then the grouping variable is used to fill in the
group table. Otherwise, the group 'column' is filled with the same values as the 'id'
column</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># don't run the example</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">sheep_ped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Kijas2016_Sheep_subset.ped"</span>,</span></span>
<span class="r-in"><span>    package<span class="op">=</span><span class="st">"detectRUNS"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sheep_gt</span> <span class="op">&lt;-</span> <span class="fu">tidypopgen</span><span class="fu">::</span><span class="fu"><a href="gen_tibble.html">gen_tibble</a></span><span class="op">(</span><span class="va">sheep_ped</span>, backingfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sheep_gt</span> <span class="op">&lt;-</span> <span class="va">sheep_gt</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu">group_by</span><span class="op">(</span><span class="va">population</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sheep_roh</span> <span class="op">&lt;-</span> <span class="fu">gt_roh_window</span><span class="op">(</span><span class="va">sheep_gt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">detectRUNS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/detectRUNS/man/plot_Runs.html" class="external-link">plot_Runs</a></span><span class="op">(</span>runs <span class="op">=</span> <span class="va">sheep_roh</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Evie Carter, Andrea Manica.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

