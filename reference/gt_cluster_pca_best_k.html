<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Find the best number of clusters based on principal components — gt_cluster_pca_best_k • tidypopgen</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Find the best number of clusters based on principal components — gt_cluster_pca_best_k"><meta property="og:description" content="This function selects the best k value based on a chosen metric and criterion.
It is equivalent to plotting the metric against the k values, and selecting
the k that fulfils a given criterion (see details for an explanation of
each criterion). This function simply adds an element 'best_k' to the
gt_cluster_pca returned by gt_cluster_pca(). The choice can be
over-ridden simply by assigning a different value to that element (e.g.
for an object x and a desired k of 8, simply use x$best_k &amp;lt;- 8)"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidypopgen</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9014</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/a01_overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/a02_qc.html">Quality Control</a>
    </li>
    <li>
      <a href="../articles/a03_example_clustering_and_dapc.html">Example workflow with tidypopgen</a>
    </li>
    <li>
      <a href="../articles/a99_plink_cheatsheet.html">plink cheatsheet</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find the best number of clusters based on principal components</h1>
    
    <div class="hidden name"><code>gt_cluster_pca_best_k.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function selects the best k value based on a chosen metric and criterion.
It is equivalent to plotting the metric against the <em>k</em> values, and selecting
the <em>k</em> that fulfils a given criterion (see details for an explanation of
each criterion). This function simply adds an element 'best_k' to the
<code>gt_cluster_pca</code> returned by <code><a href="gt_cluster_pca.html">gt_cluster_pca()</a></code>. The choice can be
over-ridden simply by assigning a different value to that element (e.g.
for an object x and a desired <em>k</em> of 8, simply use <code>x$best_k &lt;- 8</code>)</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gt_cluster_pca_best_k</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BIC"</span>, <span class="st">"AIC"</span>, <span class="st">"WSS"</span><span class="op">)</span>,</span>
<span>  criterion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"diffNgroup"</span>, <span class="st">"min"</span>, <span class="st">"goesup"</span>, <span class="st">"smoothNgoesup"</span>, <span class="st">"goodfit"</span><span class="op">)</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a <code>gt_cluster_pca</code> object obtained with <code><a href="gt_cluster_pca.html">gt_cluster_pca()</a></code></p></dd>


<dt>stat</dt>
<dd><p>a statistics, one of "BIC", "AIC" or "WSS"</p></dd>


<dt>criterion</dt>
<dd><p>one of "diffNgroup", "min", "goesup", "smoothNgoesup", "goodfit",
see details for a discussion of each approach.</p></dd>


<dt>quiet</dt>
<dd><p>boolean on whether to silence outputting information to the
screen (defaults to FALSE)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a 'gt_cluster_pca' object with an added element 'best_k'</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The analysis of data simulated under various population genetics models
(see reference) suggested an ad-hoc rule for the selection of the optimal
number of clusters. First important result is that BIC seems more
efficient than AIC and WSS to select the appropriate number of clusters
(see example). The rule of thumb consists in increasing K until it
no longer leads to an appreciable improvement of fit (i.e., to a decrease
of BIC). In the most simple models (island models), BIC decreases until
it reaches the optimal K, and then increases. In these cases, the best rule
amounts to choosing the lowest K. In other models such as stepping
stones, the decrease of BIC often continues after the optimal K,
but is much less steep, so a change in slope can be taken as an indication
of where the best <em>k</em> lies.</p>
<p>This function provides a programmatic way to select <em>k</em>.
Note that it is highly recommended to look
at the graph of BIC versus the numbers of clusters, to understand
and validate the programmatic selection. The criteria available in this
function are:</p><ul><li><p>"diffNgroup": differences between successive values of the summary
statistics (by default, BIC) are split into two groups using a Ward's
clustering method (see ?hclust), to differentiate sharp decrease from mild
decreases or increases. The retained K is the one before the first group
switch. This criterion appears to work well for island/hierarchical models, and decently
for isolation by distance models, albeit with some unstability. It can be
confounded by an initial, very sharp decrease of the test statistics. IF
UNSURE ABOUT THE CRITERION TO USE, USE THIS ONE.</p></li>
<li><p>"min": the model with the minimum summary statistics (as specified by
stat argument, BIC by default) is retained. Is likely to work for simple
island model, using BIC. It is likely to fail in models relating to
stepping stones, where the BIC always decreases (albeit by a small
amount) as K increases. In general, this approach tends to over-estimate
the number of clusters.</p></li>
<li><p>"goesup": the selected model is the K after which increasing the number
of clusters leads to increasing the summary statistics. Suffers from
inaccuracy, since i) a steep decrease might follow a small 'bump' of
increase of the statistics, and ii) increase might never happen, or
happen after negligible decreases. Is likely to work only for clear-cut
island models.</p></li>
<li><p>"smoothNgoesup": a variant of "goesup", in which the summary statistics
is first smoothed using a lowess approach. Is meant to be more accurate
than "goesup" as it is less prone to stopping to small 'bumps' in the
decrease of the statistics.</p></li>
<li><p>"goodfit": another criterion seeking a good fit with a minimum number
of clusters. This approach does not rely on differences between successive
statistics, but on absolute fit. It selects the model with the smallest
K so that the overall fit is above a given threshold.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Jombart T, Devillard S and Balloux F (2010) Discriminant analysis of
principal components: a new method for the analysis of genetically
structured populations. BMC Genetics 11:94. doi:10.1186/1471-2156-11-94</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Evie Carter, Andrea Manica.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

