<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Discriminant Analysis of Principal Components for gen_tibble — gt_dapc • tidypopgen</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Discriminant Analysis of Principal Components for gen_tibble — gt_dapc"><meta name="description" content="This function implements the Discriminant Analysis of Principal Components
(DAPC, Jombart et al. 2010). This method describes the diversity between
pre-defined groups. When groups are unknown, use gt_cluster_pca() to infer
genetic clusters. See 'details' section for a succinct description of the
method, and the vignette in the package adegenet (&quot;adegenet-dapc&quot;) for a
tutorial."><meta property="og:description" content="This function implements the Discriminant Analysis of Principal Components
(DAPC, Jombart et al. 2010). This method describes the diversity between
pre-defined groups. When groups are unknown, use gt_cluster_pca() to infer
genetic clusters. See 'details' section for a succinct description of the
method, and the vignette in the package adegenet (&quot;adegenet-dapc&quot;) for a
tutorial."><meta property="og:image" content="https://evolecolgroup.github.io/tidypopgen/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidypopgen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/tidypopgen.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a01_overview.html">The grammar of population genetics</a></li>
    <li><a class="dropdown-item" href="../articles/a02_qc.html">Quality Control</a></li>
    <li><a class="dropdown-item" href="../articles/a03_example_clustering_and_dapc.html">Population genetic analysis with tidypopgen</a></li>
    <li><a class="dropdown-item" href="../articles/a99_plink_cheatsheet.html">PLINK cheatsheet</a></li>
    <li><a class="dropdown-item" href="../articles/aDNA_pseudohaploids.html">Working with aDNA pseuodhaploid samples</a></li>
    <li><a class="dropdown-item" href="../articles/benchmark_hgdp.html">Benchmark on the HGDP</a></li>
    <li><a class="dropdown-item" href="../articles/interpolating_hgdp.html">Interpolating Heterozygosity</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EvolEcolGroup/tidypopgen/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Discriminant Analysis of Principal Components for gen_tibble</h1>
      <small class="dont-index">Source: <a href="https://github.com/EvolEcolGroup/tidypopgen/blob/dev/R/gt_dapc.R" class="external-link"><code>R/gt_dapc.R</code></a></small>
      <div class="d-none name"><code>gt_dapc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function implements the Discriminant Analysis of Principal Components
(DAPC, Jombart et al. 2010). This method describes the diversity between
pre-defined groups. When groups are unknown, use <code><a href="gt_cluster_pca.html">gt_cluster_pca()</a></code> to infer
genetic clusters. See 'details' section for a succinct description of the
method, and the vignette in the package <code>adegenet</code> ("adegenet-dapc") for a
tutorial.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gt_dapc</span><span class="op">(</span><span class="va">x</span>, pop <span class="op">=</span> <span class="cn">NULL</span>, n_pca <span class="op">=</span> <span class="cn">NULL</span>, n_da <span class="op">=</span> <span class="cn">NULL</span>, loadings_by_locus <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an object of class <code>gt_pca</code>, or its subclass <code>gt_cluster_pca</code></p></dd>


<dt id="arg-pop">pop<a class="anchor" aria-label="anchor" href="#arg-pop"></a></dt>
<dd><p>either a factor indicating the group membership of individuals; or
an integer defining the desired <em>k</em> if x is a <code>gt_cluster_pca</code>; or NULL, if
'x' is a <code>gt_cluster_pca</code> and contain an element 'best_k', usually
generated with <code><a href="gt_cluster_pca_best_k.html">gt_cluster_pca_best_k()</a></code>, which will be used to select the
clustering level.</p></dd>


<dt id="arg-n-pca">n_pca<a class="anchor" aria-label="anchor" href="#arg-n-pca"></a></dt>
<dd><p>number of principal components to be used in the Discriminant
Analysis. If NULL, k-1 will be used.</p></dd>


<dt id="arg-n-da">n_da<a class="anchor" aria-label="anchor" href="#arg-n-da"></a></dt>
<dd><p>an integer indicating the number of axes retained in the
Discriminant Analysis step.</p></dd>


<dt id="arg-loadings-by-locus">loadings_by_locus<a class="anchor" aria-label="anchor" href="#arg-loadings-by-locus"></a></dt>
<dd><p>a logical indicating whether the loadings and
contribution of each locus should be stored (TRUE, default) or not (FALSE).
Such output can be useful, but can also create large matrices when there
are a lot of loci and many dimensions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>an object of class <a href="https://rdrr.io/pkg/adegenet/man/dapc.html" class="external-link">adegenet::dapc</a></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Discriminant Analysis of Principal Components (DAPC) is designed to
investigate the genetic structure of biological populations. This
multivariate method consists in a two-steps procedure. First, genetic data
are transformed (centred, possibly scaled) and submitted to a Principal
Component Analysis (PCA). Second, principal components of PCA are submitted
to a Linear Discriminant Analysis (LDA). A trivial matrix operation allows to
express discriminant functions as linear combination of alleles, therefore
allowing one to compute allele contributions. More details about the
computation of DAPC are to be found in the indicated reference.</p>
<p>Results can be visualised with <code><a href="autoplot_gt_dapc.html">autoplot.gt_dapc()</a></code>, see the help of that
method for the available plots. There are also <a href="tidy.gt_dapc.html">gt_dapc_tidiers</a> for
manipulating the results. For the moment, this function returns objects of
class <code><a href="https://rdrr.io/pkg/adegenet/man/dapc.html" class="external-link">adegenet::dapc</a></code> which are
compatible with methods from <code>adegenet</code>; graphical methods for DAPC are
documented in adegenet::scatter.dapc (see ?scatter.dapc). This is likely
to change in the future, so make sure you do not rely on the objects
remaining compatible.</p>
<p>This function aligns with the guidelines proposed by Thia (2023) for the
standardized application of DAPC to genotype data. Our default settings are
designed to follow these recommendations, so that the number of principal
components (<code>n_pca</code>) defaults to the smaller of <em>k</em>-1 and the number of
available principal components (where <em>k</em> is the number of populations or
clusters), and the number of discriminant functions (<code>n_da</code>) is set to the
minimum of <em>k</em>-1 and <code>n_pca</code>. The user can override these defaults by
specifying the <code>n_pca</code> and <code>n_da</code> arguments, but caution is advised when
adjusting <code>n_pca</code> to avoid potential overfitting. We recommend users consult
these guidelines and consider their individual dataset to ensure best
practices.</p>
<p>Note that there is no current method to predict scores for
individuals not included in the original analysis. This is because we
currently do not have a mechanism to store the pca information in the
object, and that is needed for prediction.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jombart T, Devillard S and Balloux F (2010) Discriminant analysis
of principal components: a new method for the analysis of genetically
structured populations. BMC Genetics 11:94. doi:10.1186/1471-2156-11-94
Thia, J. A. (2023). Guidelines for standardizing the application of
discriminant analysis of principal components to genotype data. Molecular
Ecology Resources, 23, 523–538. https://doi.org/10.1111/1755-0998.13706</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="gt_cluster_pca.html">gt_cluster_pca()</a></code> <code><a href="gt_cluster_pca_best_k.html">gt_cluster_pca_best_k()</a></code> <code><a href="https://rdrr.io/pkg/adegenet/man/dapc.html" class="external-link">adegenet::dapc()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create a gen_tibble of lobster genotypes</span></span></span>
<span class="r-in"><span><span class="va">bed_file</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"lobster"</span>, <span class="st">"lobster.bed"</span>, package <span class="op">=</span> <span class="st">"tidypopgen"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lobsters</span> <span class="op">&lt;-</span> <span class="fu"><a href="gen_tibble.html">gen_tibble</a></span><span class="op">(</span><span class="va">bed_file</span>,</span></span>
<span class="r-in"><span>  backingfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"lobsters"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Remove monomorphic loci and impute</span></span></span>
<span class="r-in"><span><span class="va">lobsters</span> <span class="op">&lt;-</span> <span class="va">lobsters</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="select_loci_if.html">select_loci_if</a></span><span class="op">(</span><span class="fu"><a href="loci_alt_freq.html">loci_maf</a></span><span class="op">(</span><span class="va">genotypes</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lobsters</span> <span class="op">&lt;-</span> <span class="fu"><a href="gt_impute_simple.html">gt_impute_simple</a></span><span class="op">(</span><span class="va">lobsters</span>, method <span class="op">=</span> <span class="st">"mode"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create PCA object</span></span></span>
<span class="r-in"><span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="gt_pca_partialSVD.html">gt_pca_partialSVD</a></span><span class="op">(</span><span class="va">lobsters</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run DAPC on the `gt_pca` object, providing `pop` as factor</span></span></span>
<span class="r-in"><span><span class="va">populations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">lobsters</span><span class="op">$</span><span class="va">population</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gt_dapc</span><span class="op">(</span><span class="va">pca</span>, n_pca <span class="op">=</span> <span class="fl">6</span>, n_da <span class="op">=</span> <span class="fl">2</span>, pop <span class="op">=</span> <span class="va">populations</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  === DAPC of gen_tibble object ===</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call ($call):gt_dapc(x = pca, pop = populations, n_pca = 6, n_da = 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues ($eig):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  225.2 33.397 2.285 0.283 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LD scores ($ind.coord):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  matrix with 176 rows (individuals) and 2 columns (LD axes) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loadings by PC ($loadings):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  matrix with 6 rows (PC axes) and 2 columns (LD axes) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loadings by locus($var.load):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  matrix with 79 rows (loci) and 2 columns (LD axes) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run clustering on the first 10 PCs</span></span></span>
<span class="r-in"><span><span class="va">cluster_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="gt_cluster_pca.html">gt_cluster_pca</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">pca</span>,</span></span>
<span class="r-in"><span>  n_pca <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  k_clusters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"kmeans"</span>,</span></span>
<span class="r-in"><span>  n_iter <span class="op">=</span> <span class="fl">1e5</span>,</span></span>
<span class="r-in"><span>  n_start <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find best k</span></span></span>
<span class="r-in"><span><span class="va">cluster_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="gt_cluster_pca_best_k.html">gt_cluster_pca_best_k</a></span><span class="op">(</span><span class="va">cluster_pca</span>,</span></span>
<span class="r-in"><span>  stat <span class="op">=</span> <span class="st">"BIC"</span>,</span></span>
<span class="r-in"><span>  criterion <span class="op">=</span> <span class="st">"min"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using BIC with criterion min: 5 clusters</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run DAPC on the `gt_cluster_pca` object</span></span></span>
<span class="r-in"><span><span class="fu">gt_dapc</span><span class="op">(</span><span class="va">cluster_pca</span>, n_pca <span class="op">=</span> <span class="fl">10</span>, n_da <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  === DAPC of gen_tibble object ===</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call ($call):gt_dapc(x = cluster_pca, n_pca = 10, n_da = 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues ($eig):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  223.924 153.292 52.397 1.574 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LD scores ($ind.coord):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  matrix with 176 rows (individuals) and 2 columns (LD axes) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loadings by PC ($loadings):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  matrix with 10 rows (PC axes) and 2 columns (LD axes) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loadings by locus($var.load):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  matrix with 79 rows (loci) and 2 columns (LD axes) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#  should be stored (TRUE, default) or not (FALSE). This information is</span></span></span>
<span class="r-in"><span><span class="co">#  required to predict group membership of new individuals using predict, but</span></span></span>
<span class="r-in"><span><span class="co">#  makes the object slightly bigger.</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Evie Carter, Eirlys Tysall, Andrea Manica.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

