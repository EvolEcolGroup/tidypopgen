<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute and store blocked f2 statistics for ADMIXTOOLS 2 — gt_extract_f2 • tidypopgen</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute and store blocked f2 statistics for ADMIXTOOLS 2 — gt_extract_f2"><meta name="description" content="This function prepares data for various ADMIXTOOLS 2 functions from the
package ADMIXTOOLS 2. It takes a gen_tibble, computes allele
frequencies and blocked f2-statistics, and writes the results to outdir. It
is equivalent to admixtools::extract_f2()."><meta property="og:description" content="This function prepares data for various ADMIXTOOLS 2 functions from the
package ADMIXTOOLS 2. It takes a gen_tibble, computes allele
frequencies and blocked f2-statistics, and writes the results to outdir. It
is equivalent to admixtools::extract_f2()."><meta property="og:image" content="https://evolecolgroup.github.io/tidypopgen/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidypopgen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/tidypopgen.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a01_overview.html">The grammar of population genetics</a></li>
    <li><a class="dropdown-item" href="../articles/a02_qc.html">Quality Control</a></li>
    <li><a class="dropdown-item" href="../articles/a03_example_clustering_and_dapc.html">Population genetic analysis with tidypopgen</a></li>
    <li><a class="dropdown-item" href="../articles/a99_plink_cheatsheet.html">PLINK cheatsheet</a></li>
    <li><a class="dropdown-item" href="../articles/aDNA_pseudohaploids.html">Working with aDNA pseuodhaploid samples</a></li>
    <li><a class="dropdown-item" href="../articles/benchmark_hgdp.html">Benchmark on the HGDP</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EvolEcolGroup/tidypopgen/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute and store blocked f2 statistics for ADMIXTOOLS 2</h1>
      <small class="dont-index">Source: <a href="https://github.com/EvolEcolGroup/tidypopgen/blob/dev/R/gt_extract_f2.R" class="external-link"><code>R/gt_extract_f2.R</code></a></small>
      <div class="d-none name"><code>gt_extract_f2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function prepares data for various <em>ADMIXTOOLS 2</em> functions from the
package <em>ADMIXTOOLS 2</em>. It takes a <code><a href="gen_tibble.html">gen_tibble</a></code>, computes allele
frequencies and blocked f2-statistics, and writes the results to <code>outdir</code>. It
is equivalent to <code><a href="https://rdrr.io/pkg/admixtools/man/extract_f2.html" class="external-link">admixtools::extract_f2()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gt_extract_f2</span><span class="op">(</span></span>
<span>  <span class="va">.x</span>,</span>
<span>  outdir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  blgsize <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  maxmem <span class="op">=</span> <span class="fl">8000</span>,</span>
<span>  maxmiss <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  minmaf <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  maxmaf <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  minac2 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  outpop <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outpop_scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  transitions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  transversions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  adjust_pseudohaploid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fst <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  afprod <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  poly_only <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"f2"</span><span class="op">)</span>,</span>
<span>  apply_corr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--x">.x<a class="anchor" aria-label="anchor" href="#arg--x"></a></dt>
<dd><p>a <code><a href="gen_tibble.html">gen_tibble</a></code></p></dd>


<dt id="arg-outdir">outdir<a class="anchor" aria-label="anchor" href="#arg-outdir"></a></dt>
<dd><p>Directory where data will be stored.</p></dd>


<dt id="arg-blgsize">blgsize<a class="anchor" aria-label="anchor" href="#arg-blgsize"></a></dt>
<dd><p>SNP block size in Morgan. Default is 0.05 (5 cM). If <code>blgsize</code>
is 100 or greater, if will be interpreted as base pair distance rather than
centimorgan distance.</p></dd>


<dt id="arg-maxmem">maxmem<a class="anchor" aria-label="anchor" href="#arg-maxmem"></a></dt>
<dd><p>Maximum amount of memory to be used. If the required amount of
memory exceeds <code>maxmem</code>, allele frequency data will be split into blocks,
and the computation will be performed separately on each block pair. This
doesn't put a precise cap on the amount of memory used (it used to at some
point). Set this parameter to lower values if you run out of memory while
running this function. Set it to higher values if this function is too slow
and you have lots of memory.</p></dd>


<dt id="arg-maxmiss">maxmiss<a class="anchor" aria-label="anchor" href="#arg-maxmiss"></a></dt>
<dd><p>Discard SNPs which are missing in a fraction of populations
higher than <code>maxmiss</code></p></dd>


<dt id="arg-minmaf">minmaf<a class="anchor" aria-label="anchor" href="#arg-minmaf"></a></dt>
<dd><p>Discard SNPs with minor allele frequency less than <code>minmaf</code></p></dd>


<dt id="arg-maxmaf">maxmaf<a class="anchor" aria-label="anchor" href="#arg-maxmaf"></a></dt>
<dd><p>Discard SNPs with minor allele frequency greater than than
<code>maxmaf</code></p></dd>


<dt id="arg-minac-">minac2<a class="anchor" aria-label="anchor" href="#arg-minac-"></a></dt>
<dd><p>Discard SNPs with allele count lower than 2 in any population
(default <code>FALSE</code>). This option should be set to <code>TRUE</code> when computing
f3-statistics where one population consists mostly of pseudohaploid
samples. Otherwise heterozygosity estimates and thus f3-estimates can be
biased. <code>minac2 == 2</code> will discard SNPs with allele count lower than 2 in
any non-singleton population (this option is experimental and is based on
the hypothesis that using SNPs with allele count lower than 2 only leads to
biases in non-singleton populations). Note that, While the <code>minac2</code> option
discards SNPs with allele count lower than 2 in any population, the
<code>qp3pop</code> function will only discard SNPs with allele count lower than
2 in the first (target) population (when the first argument is the prefix
of a genotype file; i.e. it is applied directly to a genotype file, not via
precomputing f2 from a <code><a href="gen_tibble.html">gen_tibble</a></code>).</p></dd>


<dt id="arg-outpop">outpop<a class="anchor" aria-label="anchor" href="#arg-outpop"></a></dt>
<dd><p>Keep only SNPs which are heterozygous in this population</p></dd>


<dt id="arg-outpop-scale">outpop_scale<a class="anchor" aria-label="anchor" href="#arg-outpop-scale"></a></dt>
<dd><p>Scale f2-statistics by the inverse <code>outpop</code>
heterozygosity (<code>1/(p*(1-p))</code>). Providing <code>outpop</code> and setting
<code>outpop_scale</code> to <code>TRUE</code> will give the same results as the original
<em>qpGraph</em> when the <code>outpop</code> parameter has been set, but it has the
disadvantage of treating one population different from the others. This may
limit the use of these f2-statistics for other models.</p></dd>


<dt id="arg-transitions">transitions<a class="anchor" aria-label="anchor" href="#arg-transitions"></a></dt>
<dd><p>Set this to <code>FALSE</code> to exclude transition SNPs</p></dd>


<dt id="arg-transversions">transversions<a class="anchor" aria-label="anchor" href="#arg-transversions"></a></dt>
<dd><p>Set this to <code>FALSE</code> to exclude transversion SNPs</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>Overwrite existing files in <code>outdir</code></p></dd>


<dt id="arg-adjust-pseudohaploid">adjust_pseudohaploid<a class="anchor" aria-label="anchor" href="#arg-adjust-pseudohaploid"></a></dt>
<dd><p>Genotypes of pseudohaploid samples are usually
coded as <code>0</code> or <code>2</code>, even though only one allele is observed.
<code>adjust_pseudohaploid</code> ensures that the observed allele count increases
only by <code>1</code> for each pseudohaploid sample. If <code>TRUE</code> (default), samples
that don't have any genotypes coded as <code>1</code> among the first 1000 SNPs are
automatically identified as pseudohaploid. This leads to slightly more
accurate estimates of f-statistics. Setting this parameter to <code>FALSE</code>
treats all samples as diploid and is equivalent to the <em>ADMIXTOOLS</em> <code> inbreed: NO</code> option. Setting <code>adjust_pseudohaploid</code> to an integer <code>n</code> will
check the first <code>n</code> SNPs instead of the first 1000 SNPs. NOW DEPRECATED,
set the ploidy of the <code>gen_tibble</code> with <code><a href="gt_pseudohaploid.html">gt_pseudohaploid()</a></code>.</p></dd>


<dt id="arg-fst">fst<a class="anchor" aria-label="anchor" href="#arg-fst"></a></dt>
<dd><p>Write files with pairwise FST for every population pair. Setting
this to FALSE can make <code>extract_f2</code> faster and will require less memory.</p></dd>


<dt id="arg-afprod">afprod<a class="anchor" aria-label="anchor" href="#arg-afprod"></a></dt>
<dd><p>Write files with allele frequency products for every
population pair. Setting this to FALSE can make <code>extract_f2</code> faster and
will require less memory.</p></dd>


<dt id="arg-poly-only">poly_only<a class="anchor" aria-label="anchor" href="#arg-poly-only"></a></dt>
<dd><p>Specify whether SNPs with identical allele frequencies in
every population should be discarded (<code>poly_only = TRUE</code>), or whether they
should be used (<code>poly_only = FALSE</code>). By default (<code>poly_only = c("f2")</code>),
these SNPs will be used to compute FST and allele frequency products, but
not to compute f2 (this is the default option in the original ADMIXTOOLS).</p></dd>


<dt id="arg-apply-corr">apply_corr<a class="anchor" aria-label="anchor" href="#arg-apply-corr"></a></dt>
<dd><p>Apply small-sample-size correction when computing
f2-statistics (default <code>TRUE</code>)</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Parallelize computation across <code>n_cores</code> cores.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>Suppress printing of progress updates</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>SNP metadata (invisibly)</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Evie Carter, Eirlys Tysall, Andrea Manica.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

